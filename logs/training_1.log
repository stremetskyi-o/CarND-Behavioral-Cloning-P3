(/opt/carnd_p3/behavioral) root@5c6777473ccb:/home/workspace/CarND-Behavioral-Cloning-P3# python model.py
Using TensorFlow backend.
2019-04-17 11:53:18.879625: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.1 instructions, but these are available on your machine and could speed up CPU computations.
2019-04-17 11:53:18.879679: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.2 instructions, but these are available on your machine and could speed up CPU computations.
2019-04-17 11:53:18.879706: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX instructions, but these are available on your machine and could speed up CPU computations.
2019-04-17 11:53:18.879713: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX2 instructions, but these are available on your machine and could speed up CPU computations.
2019-04-17 11:53:18.879720: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use FMA instructions, but these are available on your machine and could speed up CPU computations.
2019-04-17 11:53:19.002553: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:893] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-04-17 11:53:19.003055: I tensorflow/core/common_runtime/gpu/gpu_device.cc:955] Found device 0 with properties:
name: Tesla K80
major: 3 minor: 7 memoryClockRate (GHz) 0.8235
pciBusID 0000:00:04.0
Total memory: 11.17GiB
Free memory: 11.09GiB
2019-04-17 11:53:19.003112: I tensorflow/core/common_runtime/gpu/gpu_device.cc:976] DMA: 0
2019-04-17 11:53:19.003155: I tensorflow/core/common_runtime/gpu/gpu_device.cc:986] 0:   Y
2019-04-17 11:53:19.003188: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:00:04.0)
/opt/carnd_p3/behavioral/lib/python3.5/site-packages/sklearn/utils/fixes.py:313: FutureWarning: numpy not_equal will not check object identity in the future. The comparison did not return the same result as suggested by the identity (`is`)) and will change.
  _nan_object_mask = _nan_object_array != _nan_object_array
Dataset: size = 21042 shape = (160, 320, 3)
Labels: mean = -0.00788246914096 std = 0.270527822632 straight ratio = 0.21190951430472388
Dataset size after augmentation = 42084
Train size= 33667
Validation size= 8417
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
cropping2d_1 (Cropping2D)    (None, 71, 320, 3)        0
_________________________________________________________________
lambda_1 (Lambda)            (None, 66, 200, 3)        0
_________________________________________________________________
lambda_2 (Lambda)            (None, 66, 200, 3)        0
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 31, 98, 24)        1824
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 14, 47, 36)        21636
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 5, 22, 48)         43248
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 3, 20, 64)         27712
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 1, 18, 64)         36928
_________________________________________________________________
flatten_1 (Flatten)          (None, 1152)              0
_________________________________________________________________
dense_1 (Dense)              (None, 100)               115300
_________________________________________________________________
dense_2 (Dense)              (None, 50)                5050
_________________________________________________________________
dense_3 (Dense)              (None, 10)                510
_________________________________________________________________
dense_4 (Dense)              (None, 1)                 11
=================================================================
Total params: 252,219
Trainable params: 252,219
Non-trainable params: 0
_________________________________________________________________
Epoch 1/15
2019-04-17 11:53:22.647496: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:00:04.0)
1052/1053 [============================>.] - ETA: 0s - loss: 0.0274Epoch 00001: val_loss improved from inf to 0.01761, saving model to model.h5
1053/1053 [==============================] - 69s 66ms/step - loss: 0.0273 - val_loss: 0.0176
Epoch 2/15
1052/1053 [============================>.] - ETA: 0s - loss: 0.0132Epoch 00002: val_loss improved from 0.01761 to 0.01123, saving model to model.h5
1053/1053 [==============================] - 64s 61ms/step - loss: 0.0132 - val_loss: 0.0112
Epoch 3/15
1051/1053 [============================>.] - ETA: 0s - loss: 0.0097Epoch 00003: val_loss improved from 0.01123 to 0.00830, saving model to model.h5
1053/1053 [==============================] - 65s 62ms/step - loss: 0.0097 - val_loss: 0.0083
Epoch 4/15
1052/1053 [============================>.] - ETA: 0s - loss: 0.0078Epoch 00004: val_loss improved from 0.00830 to 0.00747, saving model to model.h5
1053/1053 [==============================] - 65s 62ms/step - loss: 0.0078 - val_loss: 0.0075
Epoch 5/15
1051/1053 [============================>.] - ETA: 0s - loss: 0.0059Epoch 00005: val_loss improved from 0.00747 to 0.00599, saving model to model.h5
1053/1053 [==============================] - 65s 62ms/step - loss: 0.0059 - val_loss: 0.0060
Epoch 6/15
1052/1053 [============================>.] - ETA: 0s - loss: 0.0047Epoch 00006: val_loss improved from 0.00599 to 0.00585, saving model to model.h5
1053/1053 [==============================] - 67s 63ms/step - loss: 0.0047 - val_loss: 0.0059
Epoch 7/15
1052/1053 [============================>.] - ETA: 0s - loss: 0.0046Epoch 00007: val_loss improved from 0.00585 to 0.00481, saving model to model.h5
1053/1053 [==============================] - 69s 66ms/step - loss: 0.0046 - val_loss: 0.0048
Epoch 8/15
1052/1053 [============================>.] - ETA: 0s - loss: 0.0039Epoch 00008: val_loss improved from 0.00481 to 0.00420, saving model to model.h5
1053/1053 [==============================] - 66s 63ms/step - loss: 0.0039 - val_loss: 0.0042
Epoch 9/15
1052/1053 [============================>.] - ETA: 0s - loss: 0.0034Epoch 00009: val_loss did not improve
1053/1053 [==============================] - 66s 62ms/step - loss: 0.0034 - val_loss: 0.0045
Epoch 10/15
1051/1053 [============================>.] - ETA: 0s - loss: 0.0031Epoch 00010: val_loss improved from 0.00420 to 0.00388, saving model to model.h5
1053/1053 [==============================] - 65s 62ms/step - loss: 0.0031 - val_loss: 0.0039
Epoch 11/15
1052/1053 [============================>.] - ETA: 0s - loss: 0.0044Epoch 00011: val_loss did not improve
1053/1053 [==============================] - 66s 62ms/step - loss: 0.0044 - val_loss: 0.0043
Epoch 12/15
1052/1053 [============================>.] - ETA: 0s - loss: 0.0026Epoch 00012: val_loss improved from 0.00388 to 0.00331, saving model to model.h5
1053/1053 [==============================] - 65s 61ms/step - loss: 0.0026 - val_loss: 0.0033
Epoch 13/15
1051/1053 [============================>.] - ETA: 0s - loss: 0.0022Epoch 00013: val_loss did not improve
1053/1053 [==============================] - 66s 63ms/step - loss: 0.0022 - val_loss: 0.0038
Epoch 14/15
1051/1053 [============================>.] - ETA: 0s - loss: 0.0025Epoch 00014: val_loss did not improve
1053/1053 [==============================] - 64s 60ms/step - loss: 0.0025 - val_loss: 0.0033
Epoch 00014: early stopping